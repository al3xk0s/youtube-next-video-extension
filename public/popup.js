(()=>{var y=t=>{if(t==null)throw new Error("Null operator used at null value");return t};var x=(t,e)=>Object.fromEntries(Object.entries(t).filter(([a,n])=>e(a,n))),I=(t,e)=>Object.fromEntries(Object.entries(t).map(([a,n])=>e(a,n)));var g=(t,{query:e}={})=>e==null?t:t+"?"+new URLSearchParams(e).toString(),m=(t,{removeNulls:e=!0,removeEmptyStrings:a=!0}={})=>{let n=e?x(t,(r,o)=>o!=null):Object.fromEntries(Object.entries(t)),s=I(n,(r,o)=>[r,o.toString()]);return a?x(s,(r,o)=>o!==""):s};var w="AIzaSyCPAwaW5np0QPDc3gTdfLTYQkAL9lDIdKU";var b=(...t)=>t.join(",");var f=(()=>{let t=c=>{if("error"in c&&c.error!=null){let i=c.error;throw new Error(i.message+`(${i.code})`)}return c},e=async c=>{let i=await fetch(c),l=JSON.parse(await i.text());return t(l)},a=(c,i)=>m({part:b(...c),...i??{},key:w}),n=(c,i=["snippet"])=>{let l=g("https://youtube.googleapis.com/youtube/v3/videos",{query:a(i,{id:b(...c)})});return e(l)},s=c=>n(c,["snippet","contentDetails"]).then(i=>i.items?.map(l=>({id:y(l.id),channelID:y(l.snippet?.channelId),duration:y(l.contentDetails?.duration),published:y(l.snippet?.publishedAt)}))),r=(c,i=["snippet"])=>n([c],i).then(l=>l?.items==null?void 0:l?.items[0]),o=c=>s([c]).then(i=>i?.[0]),u=(c,i={})=>{let l=g("https://youtube.googleapis.com/youtube/v3/search",{query:a(["snippet"],{channelId:c,type:"video",...i})});return e(l)},p=(c,i=["snippet"])=>{let l=g("https://youtube.googleapis.com/youtube/v3/channels",{query:a(i,{id:c})});return e(l)};return{getVideoList:n,getSmallVideoList:s,getVideo:r,getSmallVideo:o,getSearchVideosList:u,getChannelList:p,getChannel:(c,i=["snippet"])=>p(c,i).then(l=>l.items!=null?l.items[0]:void 0),getPlaylistItemList:(c,i=["snippet"],l={})=>{let B=g("https://youtube.googleapis.com/youtube/v3/playlistItems",{query:{...m(l),...a(i,{playlistId:c})}});return e(B)}}})();var T=({worker:t,maxResults:e=50,initialPageToken:a})=>{let n=a,s=!0;return{get pageToken(){return n},get hasNext(){return s||n!=null},get isFirst(){return s},searchNext:async()=>{let o=await t.exec({maxResults:e,pageToken:n});return s&&(s=!1),n=t.tokenRetriever(o),t.resultsRetriever(o)}}};var P=(()=>{let t=n=>T({worker:{exec:s=>f.getPlaylistItemList(n,["contentDetails"],s),tokenRetriever:s=>s.nextPageToken,resultsRetriever:s=>s.items?.map(r=>r.contentDetails.videoId)??[]}});return{getChannelInfoByVideo:async n=>{let r=(await f.getVideo(n,["snippet"]))?.snippet?.channelId;if(r==null)throw new Error("Error of search channel");let u=(await f.getChannel(r,["contentDetails"]))?.contentDetails?.relatedPlaylists?.uploads;if(u==null)throw new Error("Error of fetch channel videos");return{channelID:r,uploadsPlaylistID:u}},getNextAndPreviousVideo:async(n,s)=>{let r=t(s),o=[],u=()=>o.findIndex(i=>i===n),p=()=>{let i=u();return i===-1?!1:i<o.length-1};for(;(await r.searchNext()).forEach(l=>o.push(l)),!(!r.hasNext||p()););let d=u();if(d===-1||o.length===0)throw new Error("Error of search current video");let L=d>0?o[d-1]:void 0,c=d<o.length-1?o[d+1]:void 0;return{nextVideo:L,previousVideo:c}}}})();var S=async()=>{let[t]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});return t.url};var R=t=>t.includes("youtube.com"),V=t=>new URLSearchParams(new URL(t).search).get("v"),k=t=>V(t)!=null;var h=(()=>{let t=document.querySelector("#text-display"),e=o=>t.textContent=o.trim(),a=o=>{t.classList.remove(...Array.from(t.classList.entries()).map(([u,p])=>p).filter(u=>u.includes("display-text"))),t.classList.add(o)},n=o=>{e(o),a("display-text")};return{text:n,error:o=>{e(o),a("display-text-error")},initial:()=>n("Previous, on playlist or next video")}})();var v=(()=>{let t=document.querySelector("#video-previous"),e=document.querySelector("#video-next"),a=document.querySelector("#playlist-video");return{deactivate:()=>[t,e,a].forEach(r=>{r.classList.replace("btn","buttons__button-inactive"),r.disabled=!0}),activate:()=>[t,e,a].forEach(r=>{r.classList.replace("buttons__button-inactive","btn"),r.disabled=!1}),nextButton:e,previousButton:t,toPlayListButton:a}})();var A=t=>async(...e)=>{try{return await t(...e)}catch(a){h.error(a.message)}},D=(()=>{let t=s=>{let r=new URL(s);return r.origin+r.pathname},e=s=>window.open(s,"_blank");return{openVideo:(s,r)=>e(g(t(s),{query:m({v:r})})),openVideoOnPlayList:(s,r,o)=>e(g(t(s),{query:m({v:r,list:o})}))}})(),C=async()=>{let t=new URLSearchParams(window.location.search).get("url")??await S();if(!R(t)||!k(t))throw new Error("Is not youtube or video");let e=V(t);return{url:t,videoID:e}},E=A(({mode:t})=>{h.initial();let e=({nextVideo:r,previousVideo:o})=>{if(t==="next")return r;if(t==="previous")return o},a=()=>{if(t==="next")return"It is last video";if(t==="previous")return"It is first video"},n=r=>{if(r==null)throw new Error(a())};return(async()=>{let{videoID:r,url:o}=await C(),{channelID:u,uploadsPlaylistID:p}=await P.getChannelInfoByVideo(r),d=e(await P.getNextAndPreviousVideo(r,p));n(d),D.openVideo(o,d)})()}),N=A(async()=>{h.initial();let{videoID:t,url:e}=await C(),{channelID:a,uploadsPlaylistID:n}=await P.getChannelInfoByVideo(t);D.openVideoOnPlayList(e,t,n)}),j=()=>{let{nextButton:t,previousButton:e,toPlayListButton:a}=v,n=async s=>{v.deactivate(),await s(),v.activate()};t.addEventListener("click",()=>n(()=>E({mode:"next"}))),e.addEventListener("click",()=>n(()=>E({mode:"previous"}))),a.addEventListener("click",()=>n(N))},O=async()=>{j(),h.initial()};O();})();
//# sourceMappingURL=popup.js.map
