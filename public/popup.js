(()=>{var h=t=>{if(t==null)throw new Error("Null operator used at null value");return t};var V=(t,e)=>Object.fromEntries(Object.entries(t).filter(([s,n])=>e(s,n))),P=t=>V(t,(e,s)=>s!=null),R=(t,e)=>Object.fromEntries(Object.entries(t).map(([s,n])=>e(s,n)));var g=(t,{query:e}={})=>e==null?t:t+"?"+new URLSearchParams(e).toString(),y=(t,{removeNulls:e=!0,removeEmptyStrings:s=!0}={})=>{let n=e?P(t):Object.fromEntries(Object.entries(t)),o=R(n,(r,c)=>[r,c.toString()]);return s?V(o,(r,c)=>c!==""):o};var k="AIzaSyCPAwaW5np0QPDc3gTdfLTYQkAL9lDIdKU";var L=(...t)=>t.join(",");var b=(()=>{let t=a=>{if("error"in a&&a.error!=null){let i=a.error;throw new Error(i.message+`(${i.code})`)}return a},e=async a=>{let i=await fetch(a),l=JSON.parse(await i.text());return t(l)},s=(a,i)=>y({part:L(...a),...i??{},key:k}),n=(a,i=["snippet"])=>{let l=g("https://youtube.googleapis.com/youtube/v3/videos",{query:s(i,{id:L(...a)})});return e(l)},o=a=>n(a,["snippet","contentDetails"]).then(i=>i.items?.map(l=>({id:h(l.id),channelID:h(l.snippet?.channelId),duration:h(l.contentDetails?.duration),published:h(l.snippet?.publishedAt)}))),r=(a,i=["snippet"])=>n([a],i).then(l=>l?.items==null?void 0:l?.items[0]),c=a=>o([a]).then(i=>i?.[0]),d=(a,i={})=>{let l=g("https://youtube.googleapis.com/youtube/v3/search",{query:s(["snippet"],{channelId:a,type:"video",...i})});return e(l)},m=(a,i=["snippet"])=>{let l=g("https://youtube.googleapis.com/youtube/v3/channels",{query:s(i,{id:a})});return e(l)};return{getVideoList:n,getSmallVideoList:o,getVideo:r,getSmallVideo:c,getSearchVideosList:d,getChannelList:m,getChannel:(a,i=["snippet"])=>m(a,i).then(l=>l.items!=null?l.items[0]:void 0),getPlaylistItemList:(a,i=["snippet"],l={})=>{let F=g("https://youtube.googleapis.com/youtube/v3/playlistItems",{query:{...y(l),...s(i,{playlistId:a})}});return e(F)}}})();var E=({worker:t,maxResults:e=50,initialPageToken:s})=>{let n=s,o=!0;return{get pageToken(){return n},get hasNext(){return o||n!=null},get isFirst(){return o},searchNext:async()=>{let c=await t.exec({maxResults:e,pageToken:n});return o&&(o=!1),n=t.tokenRetriever(c),t.resultsRetriever(c)}}};var x=(()=>{let t=n=>E({worker:{exec:o=>b.getPlaylistItemList(n,["contentDetails"],o),tokenRetriever:o=>o.nextPageToken,resultsRetriever:o=>o.items?.map(r=>r.contentDetails.videoId)??[]}});return{getChannelInfoByVideo:async n=>{let r=(await b.getVideo(n,["snippet"]))?.snippet?.channelId;if(r==null)throw new Error("Error of search channel");let d=(await b.getChannel(r,["contentDetails"]))?.contentDetails?.relatedPlaylists?.uploads;if(d==null)throw new Error("Error of fetch channel videos");return{channelID:r,uploadsPlaylistID:d}},getNextAndPreviousVideo:async(n,o)=>{let r=t(o),c=[],d=()=>c.findIndex(i=>i===n),m=()=>{let i=d();return i===-1?!1:i<c.length-1};for(;(await r.searchNext()).forEach(l=>c.push(l)),!(!r.hasNext||m()););let p=d();if(p===-1||c.length===0)throw new Error("Error of search current video");let u=p>0?c[p-1]:void 0,a=p<c.length-1?c[p+1]:void 0;return{nextVideo:u,previousVideo:a}}}})();var A=async()=>{let[t]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});return t.url};var D=t=>t.includes("youtube.com"),I=t=>new URLSearchParams(new URL(t).search).get("v"),N=t=>I(t)!=null;var S=t=>setTimeout(t,0),T=t=>(...e)=>{S(()=>t(...e))};var w=(t,e)=>{Object.entries(P(e)).forEach(([s,n])=>{t.style[s]=n})};var f=(()=>{let t=document.querySelector("#text-display"),e=document.querySelector("body"),s=document.querySelector("html"),n=document.querySelector(".content"),o=u=>({height:`${Math.round(u.offsetHeight)}px`,width:`${Math.round(u.offsetWidth)}px`}),r=u=>{t.textContent=u.trim(),S(()=>{w(e,o(n)),w(s,o(e))})},c=u=>{t.classList.remove(...Array.from(t.classList.entries()).map(([a,i])=>i).filter(a=>a.includes("display-text"))),t.classList.add(u)},d=T(u=>{r(u),c("display-text")}),m=T(u=>{r(u),c("display-text-error")});return{text:d,error:m,initial:()=>d("Previous, on playlist or next video")}})();var v=(()=>{let t=document.querySelector("#video-previous"),e=document.querySelector("#video-next"),s=document.querySelector("#playlist-video");return{deactivate:()=>[t,e,s].forEach(r=>{r.classList.replace("btn","buttons__button-inactive"),r.disabled=!0}),activate:()=>[t,e,s].forEach(r=>{r.classList.replace("buttons__button-inactive","btn"),r.disabled=!1}),nextButton:e,previousButton:t,toPlayListButton:s}})();var j=t=>async(...e)=>{try{return await t(...e)}catch(s){f.error(s.message)}},B=(()=>{let t=o=>{let r=new URL(o);return r.origin+r.pathname},e=o=>window.open(o,"_blank");return{openVideo:(o,r)=>e(g(t(o),{query:y({v:r})})),openVideoOnPlayList:(o,r,c)=>e(g(t(o),{query:y({v:r,list:c})}))}})(),O=async()=>{let t=new URLSearchParams(window.location.search).get("url")??await A();if(!D(t)||!N(t))throw new Error("Is not youtube or video");let e=I(t);return{url:t,videoID:e}},C=j(({mode:t})=>{f.initial();let e=({nextVideo:r,previousVideo:c})=>{if(t==="next")return r;if(t==="previous")return c},s=()=>{if(t==="next")return"It is last video";if(t==="previous")return"It is first video"},n=r=>{if(r==null)throw new Error(s())};return(async()=>{let{videoID:r,url:c}=await O(),{channelID:d,uploadsPlaylistID:m}=await x.getChannelInfoByVideo(r),p=e(await x.getNextAndPreviousVideo(r,m));n(p),B.openVideo(c,p)})()}),U=j(async()=>{f.initial();let{videoID:t,url:e}=await O(),{channelID:s,uploadsPlaylistID:n}=await x.getChannelInfoByVideo(t);B.openVideoOnPlayList(e,t,n)}),q=()=>{let{nextButton:t,previousButton:e,toPlayListButton:s}=v,n=async o=>{v.deactivate(),await o(),v.activate()};t.addEventListener("click",()=>n(()=>C({mode:"next"}))),e.addEventListener("click",()=>n(()=>C({mode:"previous"}))),s.addEventListener("click",()=>n(U))},M=async()=>{q(),f.initial()};M();})();
//# sourceMappingURL=popup.js.map
