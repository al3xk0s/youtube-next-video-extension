(()=>{var R=(...t)=>encodeURIComponent(t.join(","));var w=(()=>{let t="AIzaSyDqLwyHMwUjZ2_Jni9E98cfjWlWAHdQfL8",e=async(s,i=["snippet"])=>{let o=`https://youtube.googleapis.com/youtube/v3/videos?part=${R(...i)}&id=${R(...s)}&key=${t}`,l=await fetch(o);return JSON.parse(await l.text()).items},n=async(s,i=["snippet"])=>(await e([s],i))[0],r=async(s,i,o=50)=>{o=Math.min(50,Math.max(0,o));let l=i==null?"":`&pageToken=${i}`,p=`https://youtube.googleapis.com/youtube/v3/search?type=video&part=snippet&channelId=${s}&maxResults=${o}&order=date&key=${t}${l}`,f=await fetch(p);return JSON.parse(await f.text())};return{getChronologicVideoRange:(s,i,o=10,l)=>{let p,f=10,M=!0,b=u=>u.id===i,$=u=>{let d=u.findIndex(b);return d>-1?u.slice(Math.max(0,d-o),Math.min(d+o+1,u.length)):[]},B=async(u=50)=>{let d=await r(s,p,u);M&&(M=!1,f=Math.floor(d.pageInfo.totalResults/u)),p=d.nextPageToken;let V=d.items.map(g=>g.id.videoId);return(await e(V,["contentDetails"])).map(g=>({id:g.id.videoId,details:g.contentDetails})).filter(l)},q=async()=>{let u=0,d=[],V=async()=>{let I=await B();return I.forEach(g=>d.push(g)),I};for(;u<f&&(await V()).find(b)==null;u++);for(;u<f&&!(countStarting(d,b)-1>=o);u++)await V();return d};return(async()=>{let u=await q();return $(u)})()},getSearchVideoResponse:r,getVideoResponse:n,getVideosResponse:e,getChannelID:async s=>(await n(s,["snippet"])).snippet.channelId}})();var m=(t,e)=>{let n=e.split(t);if(n.length!==1)try{let r=Number.parseInt(n[0]);return Number.isNaN(r)?void 0:r}catch{return}},h=class t{constructor({days:e=0,hours:n=0,minutes:r=0,seconds:c=0,milliseconds:a=0}){this._days=e,this._hours=n,this._minutes=r,this._seconds=c,this._milliseconds=a}get days(){return this._days}get hours(){return this._hours}get minutes(){return this._minutes}get seconds(){return this._seconds}get milliseconds(){return this._milliseconds}get inDays(){return this.inHours/24}get inHours(){return this.inMinutes/60}get inMinutes(){return this.inSeconds/60}get inSeconds(){return this.inMilliseconds/1e3}get inMilliseconds(){return this._days*24*60*60*1e3+this._hours*60*60*1e3+this._minutes*60*1e3+this._seconds*1e3+this._milliseconds}isLess(e){return this.inMilliseconds<e.inMilliseconds}isMore(e){return this.inMilliseconds>e.inMilliseconds}isEqual(e){return this.inMilliseconds===e.inMilliseconds}isLessOrEqual(e){return this.isLess(e)||this.isEqual(e)}isMoreOrEqual(e){return this.isMore(e)||this.isEqual(e)}static{this.fromISO8601=e=>{let[n,r]=e.split("T");n=n.replace("P","");let c=m("Y",n)??0,a=m("M",n)??0,s=m("D",n)??0,i=m("H",r)??0,o=m("M",r)??0,l=m("S",r)??0;return new t({days:c*365+a*30+s,hours:i,minutes:o,seconds:l})}}};var _=new h({seconds:59}),y={get stringValues(){return Object.keys(y.values)},nextFilter(t){return this.stringValues[(this.values.indexOf(t)+1)%this.values.length]},values:{long:t=>h.fromISO8601(t.details.duration).isMore(_),shorts:t=>h.fromISO8601(t.details.duration).isLessOrEqual(_),all:t=>!0}};var L=async()=>{let[t]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});return t.url};var D=t=>t.includes("youtube.com"),F=t=>new URLSearchParams(new URL(t).search).get("v"),T=t=>F(t)!=null;var k={getValue:async()=>localStorage.getItem("filter")??"long",setValue:async t=>localStorage.setItem("filter",t)};var v=(()=>{let t=document.querySelector("#text-display"),e=s=>t.textContent=s.trim(),n=s=>{t.classList.remove(...Array.from(t.classList.entries()).map(([i,o])=>o).filter(i=>i.includes("display-text"))),t.classList.add(s)},r=s=>{e(s),n("display-text")};return{text:r,error:s=>{e(s),n("display-text-error")},initial:()=>r("Previous or next video")}})();var E=(t,e)=>{let n=t,r=[],c=l=>r.push(l),a=l=>r.forEach(p=>p(l)),s=l=>{n=l,a(n)},i=()=>n,o=()=>{r=[]};return e!=null&&c(e),{setValue:s,getValue:i,listen:c,dispose:o}};var x=(()=>{let t=document.querySelector("#video-type"),e=E(null,n=>{t.textContent=n});return{button:t,setFilterValue:e.setValue,listen:e.listen}})();var S=(()=>{let t=document.querySelector("#video-previous"),e=document.querySelector("#video-next");return{deactivate:()=>[t,e].forEach(c=>{c.classList.replace("btn","buttons__button-inactive"),c.disabled=!0}),activate:()=>[t,e].forEach(c=>{c.classList.replace("buttons__button-inactive","btn"),c.disabled=!1}),nextButton:e,previousButton:t}})();var O=({mode:t,filter:e="long"})=>{v.initial();let n=(a,s)=>{let i=s[t==="next"?0:s.length-1];if(i!==a)return i;let o=t==="next"?"It's last video":"It's first video";v.error(o)},r=(a,s)=>{let i=new URL(a);window.open(i.origin+i.pathname+`?v=${s}`,"_blank")};return(async()=>{let a=await L();if(!D(a)||!T(a))return;let s=F(a),i=await w.getChannelID(s),o=(await w.getChronologicVideoRange(i,s,1,y.values[e]??y.values.long)).map(p=>p.id);if(o.length===0){v.error("Not found");return}let l=n(s,o);l!=null&&r(a,l)})()},P=k,A=()=>{let t=async e=>{S.deactivate(),await O({mode:e,filter:await P.getValue()}),S.activate()};S.nextButton.addEventListener("click",()=>t("next")),S.previousButton.addEventListener("click",()=>t("previous"))},N=()=>{x.listen(e=>x.setFilterValue(e));let t=async()=>{let e=await P.getValue(),n=y.nextFilter(e);return x.setFilterValue(n)};x.button.addEventListener("click",t)},C=()=>{A(),N(),v.initial()};C();})();
//# sourceMappingURL=popup.js.map
